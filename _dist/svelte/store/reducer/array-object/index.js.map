{"version":3,"file":"index.js","sources":["../../../../../src/svelte/store/reducer/array-object/ObjectEntryStore.ts","../../../../../src/svelte/store/reducer/array-object/ArrayObjectStore.ts","../../../../../src/svelte/store/reducer/array-object/CrudArrayObjectStore.ts"],"sourcesContent":["import { Hashing }               from '#runtime/util';\r\nimport { isObject }              from '#runtime/util/object';\r\n\r\nimport type {\r\n   Subscriber,\r\n   Unsubscriber }                from 'svelte/store';\r\n\r\nimport type { MinimalWritable }  from '#runtime/svelte/store/util';\r\n\r\nimport type { ArrayObjectStore } from './ArrayObjectStore';\r\n\r\n/**\r\n * Provides a base implementation for store entries in {@link ArrayObjectStore}.\r\n *\r\n * In particular providing the required getting / accessor for the 'id' property.\r\n */\r\nexport abstract class ObjectEntryStore<T extends ArrayObjectStore.Data.BaseArrayObject =\r\n ArrayObjectStore.Data.BaseArrayObject> implements ArrayObjectStore.Data.BaseObjectEntryStore<T>\r\n{\r\n   /**\r\n    */\r\n   readonly #data: T;\r\n\r\n   /**\r\n    * Stores the subscribers.\r\n    */\r\n   #subscribers: Subscriber<T>[] = [];\r\n\r\n   /**\r\n    * Invoked by ArrayObjectStore to provide custom duplication. Override this static method in your entry store.\r\n    *\r\n    * @param data - A copy of local data w/ new ID already set.\r\n    *\r\n    * @param arrayStore - The source ArrayObjectStore instance.\r\n    */\r\n   static duplicate<S extends ArrayObjectStore<any>>(data: object, arrayStore: S): void {}  // eslint-disable-line no-unused-vars\r\n\r\n   /**\r\n    * @param data -\r\n    */\r\n   constructor(data: T)\r\n   {\r\n      if (!isObject(data)) { throw new TypeError(`'data' is not an object.`); }\r\n\r\n      this.#data = data;\r\n\r\n      // If `id` is missing then add it.\r\n      if (typeof this.#data.id !== 'string') { this.#data.id = Hashing.uuidv4(); }\r\n\r\n      if (!Hashing.isUuidv4(this.#data.id))\r\n      {\r\n         throw new Error(`'data.id' (${this.#data.id}) is not a valid UUIDv4 string.`);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * @returns The object data tracked by this store.\r\n    */\r\n   protected get _data(): T { return this.#data; }\r\n\r\n   /**\r\n    * @returns The ID attribute in object data tracked by this store.\r\n    */\r\n   get id(): string { return this.#data.id as string; }\r\n\r\n   // ----------------------------------------------------------------------------------------------------------------\r\n\r\n   /**\r\n    * To be implemented by child implementations as required by the {@link MinimalWritable} contract. You must manually\r\n    * invoke {@link ObjectEntryStore._updateSubscribers} to notify subscribers.\r\n    *\r\n    * @param data Data to set to store.\r\n    */\r\n   abstract set(data: T): void;\r\n\r\n   /**\r\n    * @returns A JSON data object for the backing data. The default implementation directly returns the backing private\r\n    *          data object. You may override this method to clone the data via {@link ObjectEntryStore._data}.\r\n    */\r\n   toJSON(): T\r\n   {\r\n      return this.#data;\r\n   }\r\n\r\n   /**\r\n    * @param handler - Callback function that is invoked on update / changes.\r\n    *\r\n    * @returns Unsubscribe function.\r\n    */\r\n   subscribe(handler: Subscriber<T>): Unsubscriber\r\n   {\r\n      this.#subscribers.push(handler);  // add handler to the array of subscribers\r\n\r\n      handler(this.#data);                // call handler with current value\r\n\r\n      // Return unsubscribe function.\r\n      return (): void =>\r\n      {\r\n         const index: number = this.#subscribers.findIndex((sub: Subscriber<T>): boolean => sub === handler);\r\n         if (index >= 0) { this.#subscribers.splice(index, 1); }\r\n      };\r\n   }\r\n\r\n   /**\r\n    * Update subscribers of this store. Useful for child implementations.\r\n    */\r\n   protected _updateSubscribers(): void\r\n   {\r\n      for (let cntr: number = 0; cntr < this.#subscribers.length; cntr++) { this.#subscribers[cntr](this.#data); }\r\n   }\r\n}\r\n","import { DynArrayReducer }       from '#runtime/svelte/store/reducer';\r\n\r\nimport {\r\n   isMinimalWritableStore,\r\n   subscribeIgnoreFirst }        from '#runtime/svelte/store/util';\r\n\r\nimport {\r\n   Hashing,\r\n   Timing }                      from '#runtime/util';\r\n\r\nimport {\r\n   hasGetter,\r\n   isObject,\r\n   klona }                       from '#runtime/util/object';\r\n\r\nimport { ObjectEntryStore }      from './ObjectEntryStore';\r\n\r\nimport type {\r\n   Subscriber,\r\n   Unsubscriber }                from 'svelte/store';\r\n\r\nimport type { MinimalWritable }  from '#runtime/svelte/store/util';\r\n\r\n/**\r\n * @typeParam S - Store type.\r\n */\r\nclass ArrayObjectStore<S extends ArrayObjectStore.Data.BaseObjectEntryStore<any>>\r\n{\r\n   /**\r\n    */\r\n   #data: S[] = [];\r\n\r\n   /**\r\n    */\r\n   #dataMap: Map<string, { store: S, unsubscribe: Unsubscriber }> = new Map();\r\n\r\n   /**\r\n    */\r\n   readonly #dataReducer?: DynArrayReducer<S>;\r\n\r\n   /**\r\n    */\r\n   readonly #manualUpdate: boolean;\r\n\r\n   /**\r\n    */\r\n   readonly #StoreClass: {\r\n      new (...args: any[]): S;\r\n      duplicate?(data: any, arrayStore: ArrayObjectStore<any>): void\r\n   };\r\n\r\n   /**\r\n    * Stores the subscribers.\r\n    */\r\n   #subscribers: Subscriber<S[]>[] = [];\r\n\r\n   /**\r\n    */\r\n   readonly #updateSubscribersBound: (update: boolean | ArrayObjectStore.Util.ExtractDataType<S> | undefined) => void;\r\n\r\n   /**\r\n    * @returns The default object entry store constructor that can facilitate the creation of the required\r\n    *          {@link ArrayObjectStore.Options.Config.StoreClass} and generic `T` type parameter.\r\n    */\r\n   static get EntryStore(): typeof ObjectEntryStore { return ObjectEntryStore; }\r\n\r\n   /**\r\n    * @param options - ArrayObjectStore options.\r\n    */\r\n   constructor({ StoreClass, childDebounce = 250, dataReducer = false, manualUpdate = false }:\r\n    ArrayObjectStore.Options.Config<S>)\r\n   {\r\n      if (!Number.isInteger(childDebounce) || childDebounce < 0 || childDebounce > 1000)\r\n      {\r\n         throw new TypeError(`'childDebounce' must be an integer between and including 0 - 1000.`);\r\n      }\r\n\r\n      if (typeof manualUpdate !== 'boolean') { throw new TypeError(`'manualUpdate' is not a boolean.`); }\r\n\r\n      if (!isMinimalWritableStore(StoreClass.prototype))\r\n      {\r\n         throw new TypeError(`'StoreClass' is not a minimal writable store constructor.`);\r\n      }\r\n\r\n      if (!hasGetter(StoreClass.prototype, 'id'))\r\n      {\r\n         throw new TypeError(`'StoreClass' does not have a getter accessor for 'id' property.`);\r\n      }\r\n\r\n      this.#manualUpdate = manualUpdate;\r\n\r\n      this.#StoreClass = StoreClass;\r\n\r\n      if (dataReducer) { this.#dataReducer = new DynArrayReducer({ data: this.#data }); }\r\n\r\n      // Prepare a debounced callback that is used for all child store entry subscriptions.\r\n      this.#updateSubscribersBound = childDebounce === 0 ? this.updateSubscribers.bind(this) :\r\n       Timing.debounce((update: boolean | ArrayObjectStore.Util.ExtractDataType<S> | undefined): void =>\r\n        this.updateSubscribers(update), childDebounce);\r\n   }\r\n\r\n   /**\r\n    * Provide an iterator for public access to entry stores.\r\n    *\r\n    * @returns iterator\r\n    */\r\n   *[Symbol.iterator](): IterableIterator<S>\r\n   {\r\n      if (this.#data.length === 0) { return; }\r\n\r\n      for (const entryStore of this.#data) { yield entryStore; }\r\n   }\r\n\r\n   /**\r\n    * @returns The internal data array tracked allowing child classes direct access.\r\n    */\r\n   protected get _data(): S[] { return this.#data; }\r\n\r\n   /**\r\n    * @returns The data reducer.\r\n    */\r\n   get dataReducer(): DynArrayReducer<S>\r\n   {\r\n      if (!this.#dataReducer)\r\n      {\r\n         throw new Error(\r\n          `'dataReducer' is not initialized; did you forget to specify 'dataReducer' as true in constructor options?`);\r\n      }\r\n\r\n      return this.#dataReducer;\r\n   }\r\n\r\n   /**\r\n    * @returns The length of all data.\r\n    */\r\n   get length(): number { return this.#data.length; }\r\n\r\n   /**\r\n    * Removes all child store entries.\r\n    */\r\n   clearEntries(): void\r\n   {\r\n      for (const storeEntryData of this.#dataMap.values()) { storeEntryData.unsubscribe(); }\r\n\r\n      this.#dataMap.clear();\r\n      this.#data.length = 0;\r\n\r\n      this.updateSubscribers();\r\n   }\r\n\r\n   /**\r\n    * Creates a new store from given data.\r\n    *\r\n    * @param entryData - Entry data.\r\n    *\r\n    * @returns The store\r\n    */\r\n   createEntry(entryData: ArrayObjectStore.Util.ExtractDataType<S>): S\r\n   {\r\n      if (!isObject(entryData)) { throw new TypeError(`'entryData' is not an object.`); }\r\n\r\n      if (!Hashing.isUuidv4(entryData.id)) { entryData.id = Hashing.uuidv4(); }\r\n\r\n      if (this.#data.findIndex((entry: S): boolean => entry.id === entryData.id) >= 0)\r\n      {\r\n         throw new Error(`'entryData.id' (${entryData.id}) already in this ArrayObjectStore instance.`);\r\n      }\r\n\r\n      // The required `id` is added to `entryData` if not defined.\r\n      const store: S = this.#createStore(entryData);\r\n\r\n      this.updateSubscribers();\r\n\r\n      return store;\r\n   }\r\n\r\n   /**\r\n    * Add a new store entry from the given data.\r\n    *\r\n    * @param entryData - Entry data.\r\n    *\r\n    * @returns New store entry instance.\r\n    */\r\n   #createStore(entryData: ArrayObjectStore.Util.ExtractDataType<S>): S\r\n   {\r\n      const store = new this.#StoreClass(entryData, this);\r\n\r\n      if (!Hashing.isUuidv4(store.id))\r\n      {\r\n         throw new Error(`'store.id' (${store.id}) is not a UUIDv4 compliant string.`);\r\n      }\r\n\r\n      const unsubscribe: Unsubscriber = subscribeIgnoreFirst(store, this.#updateSubscribersBound);\r\n\r\n      this.#data.push(store);\r\n      this.#dataMap.set(store.id, { store, unsubscribe });\r\n\r\n      return store;\r\n   }\r\n\r\n   /**\r\n    * Deletes a given entry store by ID from this world setting array store instance.\r\n    *\r\n    * @param id - ID of entry to delete.\r\n    *\r\n    * @returns Delete operation successful.\r\n    */\r\n   deleteEntry(id: string): boolean\r\n   {\r\n      const result: boolean = this.#deleteStore(id);\r\n\r\n      if (result) { this.updateSubscribers(); }\r\n\r\n      return result;\r\n   }\r\n\r\n   #deleteStore(id: string): boolean\r\n   {\r\n      if (typeof id !== 'string') { throw new TypeError(`'id' is not a string.`); }\r\n\r\n      const storeEntryData: { store: S, unsubscribe: Unsubscriber } | undefined = this.#dataMap.get(id);\r\n      if (storeEntryData)\r\n      {\r\n         storeEntryData.unsubscribe();\r\n\r\n         this.#dataMap.delete(id);\r\n\r\n         const index: number = this.#data.findIndex((entry: S): boolean => entry.id === id);\r\n         if (index >= 0) { this.#data.splice(index, 1); }\r\n\r\n         return true;\r\n      }\r\n\r\n      return false;\r\n   }\r\n\r\n   /**\r\n    * Duplicates an entry store by the given ID.\r\n    *\r\n    * @param {string}   id - UUIDv4 string.\r\n    *\r\n    * @returns {*} Instance of StoreClass.\r\n    */\r\n   duplicateEntry(id: string): S | undefined\r\n   {\r\n      if (typeof id !== 'string') { throw new TypeError(`'id' is not a string.`); }\r\n\r\n      const storeEntryData: { store: S, unsubscribe: Unsubscriber } | undefined = this.#dataMap.get(id);\r\n\r\n      if (storeEntryData)\r\n      {\r\n         const data: ArrayObjectStore.Util.ExtractDataType<S> = klona(storeEntryData.store.toJSON());\r\n         data.id = Hashing.uuidv4();\r\n\r\n         // Allow StoreClass to statically perform any specialized duplication.\r\n         this.#StoreClass?.duplicate?.(data, this);\r\n\r\n         return this.createEntry(data);\r\n      }\r\n\r\n      return void 0;\r\n   }\r\n\r\n   /**\r\n    * Find an entry in the backing child store array.\r\n    *\r\n    * @param predicate - A predicate function.\r\n    *\r\n    * @returns Found entry in array or undefined.\r\n    */\r\n   findEntry(predicate: (value: S, index: number, obj: S[]) => unknown): S | undefined\r\n   {\r\n      return this.#data.find(predicate);\r\n   }\r\n\r\n   /**\r\n    * Finds an entry store instance by 'id' / UUIDv4.\r\n    *\r\n    * @param id - A UUIDv4 string.\r\n    *\r\n    * @returns Entry store instance.\r\n    */\r\n   getEntry(id: string): S | undefined\r\n   {\r\n      const storeEntryData: { store: S, unsubscribe: Unsubscriber } | undefined = this.#dataMap.get(id);\r\n      return storeEntryData ? storeEntryData.store : void 0;\r\n   }\r\n\r\n   /**\r\n    * Sets the children store data by 'id', adds new entry store instances, or removes entries that are no longer in the\r\n    * update list.\r\n    *\r\n    * @param updateList -\r\n    */\r\n   set(updateList: ArrayObjectStore.Util.ExtractDataType<S>[]): void\r\n   {\r\n      if (!Array.isArray(updateList))\r\n      {\r\n         console.warn(`ArrayObjectStore.set warning: aborting set operation as 'updateList' is not an array.`);\r\n         return;\r\n      }\r\n\r\n      // Create a set of all current entry IDs.\r\n      const removeIDSet = new Set(this.#dataMap.keys());\r\n\r\n      let rebuildIndex: boolean = false;\r\n\r\n      for (let updateIndex: number = 0; updateIndex < updateList.length; updateIndex++)\r\n      {\r\n         const updateData: ArrayObjectStore.Util.ExtractDataType<S> = updateList[updateIndex];\r\n\r\n         const id: string = updateData.id;\r\n\r\n         if (typeof id !== 'string') { throw new Error(`'updateData.id' is not a string.`); }\r\n\r\n         const localIndex: number = this.#data.findIndex((entry: S): boolean => entry.id === id);\r\n\r\n         if (localIndex >= 0)\r\n         {\r\n            const localEntry: S = this.#data[localIndex];\r\n\r\n            // Update the entry data.\r\n            localEntry.set(updateData);\r\n\r\n            // Must move to correct position\r\n            if (localIndex !== updateIndex)\r\n            {\r\n               // Remove from current location.\r\n               this.#data.splice(localIndex, 1);\r\n\r\n               if (updateIndex < this.#data.length)\r\n               {\r\n                  // Insert at new location.\r\n                  this.#data.splice(updateIndex, 0, localEntry);\r\n               }\r\n               else\r\n               {\r\n                  // Local data length is less than update data index; rebuild index.\r\n                  rebuildIndex = true;\r\n               }\r\n            }\r\n\r\n            // Delete from removeIDSet as entry is still in local data.\r\n            removeIDSet.delete(id);\r\n         }\r\n         else\r\n         {\r\n            this.#createStore(updateData);\r\n         }\r\n      }\r\n\r\n      if (rebuildIndex)\r\n      {\r\n         // Must invoke unsubscribe for all child stores.\r\n         for (const storeEntryData of this.#dataMap.values()) { storeEntryData.unsubscribe(); }\r\n\r\n         this.#data.length = 0;\r\n         this.#dataMap.clear();\r\n\r\n         for (const updateData of updateList) { this.#createStore(updateData); }\r\n      }\r\n      else\r\n      {\r\n         // Remove entries that are no longer in data.\r\n         for (const id of removeIDSet) { this.#deleteStore(id); }\r\n      }\r\n\r\n      this.updateSubscribers();\r\n   }\r\n\r\n   toJSON(): S[]\r\n   {\r\n      return this.#data;\r\n   }\r\n\r\n// -------------------------------------------------------------------------------------------------------------------\r\n\r\n   /**\r\n    * @param handler - Callback function that is invoked on update / changes.\r\n    *\r\n    * @returns Unsubscribe function.\r\n    */\r\n   subscribe(handler: Subscriber<S[]>): Unsubscriber\r\n   {\r\n      this.#subscribers.push(handler); // add handler to the array of subscribers\r\n\r\n      handler(this.#data);                     // call handler with current value\r\n\r\n      // Return unsubscribe function.\r\n      return (): void =>\r\n      {\r\n         const index: number = this.#subscribers.findIndex((sub: Subscriber<S[]>): boolean => sub === handler);\r\n         if (index >= 0) { this.#subscribers.splice(index, 1); }\r\n      };\r\n   }\r\n\r\n   /**\r\n    * Updates subscribers.\r\n    *\r\n    * @param [update] -\r\n    */\r\n   updateSubscribers(update: boolean | ArrayObjectStore.Util.ExtractDataType<S> | undefined = void 0): void\r\n   {\r\n      const updateGate: boolean = typeof update === 'boolean' ? update : !this.#manualUpdate;\r\n\r\n      if (updateGate)\r\n      {\r\n         for (let cntr: number = 0; cntr < this.#subscribers.length; cntr++) { this.#subscribers[cntr](this.#data); }\r\n      }\r\n\r\n      // This will update the filtered data and `dataReducer` store and forces an update to subscribers.\r\n      if (this.#dataReducer) { this.#dataReducer.index.update(true); }\r\n   }\r\n}\r\n\r\ndeclare namespace ArrayObjectStore {\r\n   export namespace Data {\r\n      export interface BaseArrayObject {\r\n         /**\r\n          * Optional UUIDv4 compatible ID string.\r\n          */\r\n         id?: string;\r\n      }\r\n\r\n      /**\r\n       * @typeParam D - Store data type.\r\n       */\r\n      export interface BaseObjectEntryStore<D> extends MinimalWritable<D> {\r\n         /**\r\n          * @returns UUIDv4 compatible string.\r\n          */\r\n         get id(): string;\r\n\r\n         /**\r\n          * Convert or return data in JSON.\r\n          *\r\n          * @returns JSON data.\r\n          */\r\n         toJSON(): D;\r\n      }\r\n   }\r\n\r\n   export namespace Options {\r\n      /**\r\n       * @typeParam S - Store type.\r\n       */\r\n      export interface Config<S extends Data.BaseObjectEntryStore<any>> {\r\n         /**\r\n          * The entry store class that is instantiated.\r\n          */\r\n         StoreClass: new (...args: any[]) => S;\r\n\r\n         /**\r\n          * An array of default data objects.\r\n          */\r\n         defaultData?: Util.ExtractDataType<S>[];\r\n\r\n         /**\r\n          * An integer between and including 0 - 1000; a debounce time in milliseconds for child store subscriptions to\r\n          * invoke {@link ArrayObjectStore.updateSubscribers} notifying subscribers to this array store. Default\r\n          * value: `250`.\r\n          */\r\n         childDebounce?: number;\r\n\r\n         /**\r\n          * When true a {@link DynArrayReducer} will be instantiated wrapping store data and accessible from\r\n          * {@link ArrayObjectStore.dataReducer}; default value: `false`.\r\n          */\r\n         dataReducer?: boolean;\r\n\r\n         /**\r\n          * When true {@link ArrayObjectStore.updateSubscribers} must be invoked with a single boolean parameter for\r\n          * subscribers to be updated; default value: `false`.\r\n          */\r\n         manualUpdate?: boolean;\r\n      }\r\n   }\r\n\r\n   export namespace Util {\r\n      /**\r\n       * Utility type that extracts and infers generic data type of store.\r\n       *\r\n       * @typeParam S - Store type.\r\n       */\r\n      export type ExtractDataType<S> = S extends Data.BaseObjectEntryStore<infer D> ? D : never;\r\n   }\r\n}\r\n\r\n\r\nexport { ArrayObjectStore }\r\n","import { Hashing }            from '#runtime/util';\r\n\r\nimport { isObject }           from '#runtime/util/object';\r\n\r\nimport { ArrayObjectStore }   from './ArrayObjectStore';\r\n\r\n/**\r\n * @typeParam S - Store type.\r\n */\r\nclass CrudArrayObjectStore<S extends CrudArrayObjectStore.Data.BaseObjectEntryStore<any>> extends ArrayObjectStore<S>\r\n{\r\n   /**\r\n    */\r\n   readonly #crudDispatch: CrudArrayObjectStore.Options.CrudDispatch<CrudArrayObjectStore.Util.ExtractDataType<S>> |\r\n    undefined;\r\n\r\n   /**\r\n    */\r\n   readonly #extraData: { [key: string]: any };\r\n\r\n   /**\r\n    * @param options - CrudArrayObjectStore options.\r\n    */\r\n   constructor({ crudDispatch, extraData, ...rest }: CrudArrayObjectStore.Options.Config<S>)\r\n   {\r\n      // 'manualUpdate' is set to true if 'crudUpdate' is defined, but can be overridden by `...rest`.\r\n      super({\r\n         manualUpdate: typeof crudDispatch === 'function',\r\n         ...rest,\r\n      });\r\n\r\n      if (crudDispatch !== void 0 && typeof crudDispatch !== 'function')\r\n      {\r\n         throw new TypeError(`'crudDispatch' is not a function.`);\r\n      }\r\n\r\n      if (extraData !== void 0 && !isObject(extraData))\r\n      {\r\n         throw new TypeError(`'extraData' is not an object.`);\r\n      }\r\n\r\n      this.#crudDispatch = crudDispatch;\r\n      this.#extraData = extraData ?? {};\r\n   }\r\n\r\n   /**\r\n    * Removes all child store entries.\r\n    */\r\n   override clearEntries(): void\r\n   {\r\n      super.clearEntries();\r\n\r\n      if (this.#crudDispatch)\r\n      {\r\n         this.#crudDispatch({ action: 'clear', ...this.#extraData });\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Creates a new store from given data.\r\n    *\r\n    * @param entryData -\r\n    *\r\n    * @returns Associated store with entry data.\r\n    */\r\n   override createEntry(entryData: CrudArrayObjectStore.Util.ExtractDataType<S>): S\r\n   {\r\n      const store: S = super.createEntry(entryData);\r\n\r\n      if (store && this.#crudDispatch)\r\n      {\r\n         this.#crudDispatch({\r\n            action: 'create',\r\n            ...this.#extraData,\r\n            id: store.id,\r\n            data: store.toJSON()\r\n         });\r\n      }\r\n\r\n      return store;\r\n   }\r\n\r\n   /**\r\n    * Deletes a given entry store by ID from this world setting array store instance.\r\n    *\r\n    * @param id - ID of entry to delete.\r\n    *\r\n    * @returns Delete operation successful.\r\n    */\r\n   override deleteEntry(id: string): boolean\r\n   {\r\n      const result: boolean = super.deleteEntry(id);\r\n\r\n      if (result && this.#crudDispatch)\r\n      {\r\n         this.#crudDispatch({ action: 'delete', ...this.#extraData, id });\r\n      }\r\n\r\n      return result;\r\n   }\r\n\r\n   /**\r\n    * Updates subscribers, but provides special handling when a `crudDispatch` function is attached. When `update` is\r\n    * an object with a valid UUIDv4 string as the id property the `crudDispatch` function is invoked along with the\r\n    * data payload.\r\n    *\r\n    * @param [update] - A boolean indicating that subscribers should be notified otherwise\r\n    */\r\n   override updateSubscribers(update: boolean | CrudArrayObjectStore.Util.ExtractDataType<S> | undefined = void 0): void\r\n   {\r\n      if (this.#crudDispatch && isObject(update) && Hashing.isUuidv4(update.id))\r\n      {\r\n         const result: boolean = this.#crudDispatch({\r\n            action: 'update',\r\n            ...this.#extraData,\r\n            id: update.id,\r\n            data: update  // TODO: Consider using klona to clone data.\r\n         });\r\n\r\n         // If the crudDispatch function returns a boolean then invoke 'ArrayObjectStore.updateSubscribers' with it.\r\n         super.updateSubscribers(typeof result === 'boolean' ? result : update);\r\n      }\r\n      else\r\n      {\r\n         super.updateSubscribers(update);\r\n      }\r\n   }\r\n}\r\n\r\ndeclare namespace CrudArrayObjectStore {\r\n   export import Data = ArrayObjectStore.Data;\r\n   export import Util = ArrayObjectStore.Util;\r\n\r\n   export namespace Options {\r\n      /**\r\n       * @typeParam S - Store type.\r\n       */\r\n      export interface Config<S extends Data.BaseObjectEntryStore<any>> extends ArrayObjectStore.Options.Config<S> {\r\n         /**\r\n          * Optional dispatch function to receive C(R)UD updates on create, update, delete actions.\r\n          */\r\n         crudDispatch?: CrudDispatch<Util.ExtractDataType<S>>;\r\n\r\n         /**\r\n          * Optional additional data that is dispatched with `CrudDispatch` callbacks.\r\n          */\r\n         extraData?: { [key: string]: any };\r\n      }\r\n\r\n      /**\r\n       * A function that accepts an object w/ 'action', 'moduleId', 'key' properties and optional 'id' / UUIDv4 string\r\n       * and 'data' property.\r\n       *\r\n       * @typeParam D - Store data type.\r\n       */\r\n      export type CrudDispatch<D> = (data: { action: string, id?: string, data?: D, [key: string]: any; }) => boolean;\r\n   }\r\n}\r\n\r\nexport { CrudArrayObjectStore };\r\n"],"names":[],"mappings":"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"}