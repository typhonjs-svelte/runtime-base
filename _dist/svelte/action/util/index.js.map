{"version":3,"file":"index.js","sources":["../../../../src/svelte/action/util/dynamic/dynamicAction.js"],"sourcesContent":["import { isObject } from '#runtime/util/object';\r\n\r\n/**\r\n * Applies the given action dynamically allowing the hosted action to be updated reactively while still appropriately\r\n * handling the action lifecycle methods.\r\n *\r\n * @param {HTMLElement} node - The node associated with the action.\r\n *\r\n * @param {import('./types').DynamicActionOptions} options - Defines the action to dynamically mount.\r\n *\r\n * @returns {import('svelte/action').ActionReturn<import('./types').DynamicActionOptions>} The action lifecycle\r\n *          methods.\r\n */\r\nexport function dynamicAction(node, { action, data } = {})\r\n{\r\n   let actionResult;\r\n\r\n   if (typeof action === 'function') { actionResult = action(node, data); }\r\n\r\n   return {\r\n      /**\r\n       * @param {import('./types').DynamicActionOptions} newOptions - Defines the new action to dynamically mount.\r\n       */\r\n      update: (newOptions) =>\r\n      {\r\n         // If `newOptions` is not an object then destroy any old action.\r\n         if (!isObject(newOptions))\r\n         {\r\n            actionResult?.destroy?.();\r\n            action = void 0;\r\n            data = void 0;\r\n\r\n            return;\r\n         }\r\n\r\n         const { action: newAction, data: newData } = newOptions;\r\n\r\n         if (typeof newAction !== 'function')\r\n         {\r\n            console.warn(`dynamicAction.update warning: Aborting as 'action' is not a function.`);\r\n            return;\r\n         }\r\n\r\n         const hasNewData = newData !== data;\r\n\r\n         if (hasNewData) { data = newData; }\r\n\r\n         if (newAction !== action)\r\n         {\r\n            // If the action changes destroy the previous action and apply the new one.\r\n            actionResult?.destroy?.();\r\n\r\n            action = newAction;\r\n            actionResult = action(node, data);\r\n         }\r\n         else if (hasNewData)\r\n         {\r\n            actionResult?.update?.(data);\r\n         }\r\n      },\r\n\r\n      destroy: () =>\r\n      {\r\n         actionResult?.destroy?.();\r\n\r\n         action = void 0;\r\n         data = void 0;\r\n         actionResult = void 0;\r\n      }\r\n   };\r\n}\r\n"],"names":[],"mappings":";;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,aAAa,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE;AACzD;AACA,GAAG,IAAI,YAAY,CAAC;AACpB;AACA,GAAG,IAAI,OAAO,MAAM,KAAK,UAAU,EAAE,EAAE,YAAY,GAAG,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,EAAE;AAC3E;AACA,GAAG,OAAO;AACV;AACA;AACA;AACA,MAAM,MAAM,EAAE,CAAC,UAAU;AACzB,MAAM;AACN;AACA,SAAS,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC;AAClC,SAAS;AACT,YAAY,YAAY,EAAE,OAAO,IAAI,CAAC;AACtC,YAAY,MAAM,GAAG,KAAK,CAAC,CAAC;AAC5B,YAAY,IAAI,GAAG,KAAK,CAAC,CAAC;AAC1B;AACA,YAAY,OAAO;AACnB,UAAU;AACV;AACA,SAAS,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,UAAU,CAAC;AACjE;AACA,SAAS,IAAI,OAAO,SAAS,KAAK,UAAU;AAC5C,SAAS;AACT,YAAY,OAAO,CAAC,IAAI,CAAC,CAAC,qEAAqE,CAAC,CAAC,CAAC;AAClG,YAAY,OAAO;AACnB,UAAU;AACV;AACA,SAAS,MAAM,UAAU,GAAG,OAAO,KAAK,IAAI,CAAC;AAC7C;AACA,SAAS,IAAI,UAAU,EAAE,EAAE,IAAI,GAAG,OAAO,CAAC,EAAE;AAC5C;AACA,SAAS,IAAI,SAAS,KAAK,MAAM;AACjC,SAAS;AACT;AACA,YAAY,YAAY,EAAE,OAAO,IAAI,CAAC;AACtC;AACA,YAAY,MAAM,GAAG,SAAS,CAAC;AAC/B,YAAY,YAAY,GAAG,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;AAC9C,UAAU;AACV,cAAc,IAAI,UAAU;AAC5B,SAAS;AACT,YAAY,YAAY,EAAE,MAAM,GAAG,IAAI,CAAC,CAAC;AACzC,UAAU;AACV,OAAO;AACP;AACA,MAAM,OAAO,EAAE;AACf,MAAM;AACN,SAAS,YAAY,EAAE,OAAO,IAAI,CAAC;AACnC;AACA,SAAS,MAAM,GAAG,KAAK,CAAC,CAAC;AACzB,SAAS,IAAI,GAAG,KAAK,CAAC,CAAC;AACvB,SAAS,YAAY,GAAG,KAAK,CAAC,CAAC;AAC/B,OAAO;AACP,IAAI,CAAC;AACL;;;;"}