{"version":3,"file":"index.js","sources":["../../../../../src/svelte/action/dom/style/applyStyles.ts","../../../../../src/svelte/action/dom/style/applyVisualEdgeInsets.ts"],"sourcesContent":["import { isObject }           from '#runtime/util/object';\r\n\r\nimport type { ActionReturn }  from 'svelte/action';\r\n\r\n/**\r\n * Provides an action to apply CSS style properties provided as an object.\r\n *\r\n * @param node - Target element\r\n *\r\n * @param properties - Hyphen case CSS property key / value object of properties to set.\r\n *\r\n * @returns Action lifecycle functions.\r\n */\r\nexport function applyStyles(node: HTMLElement, properties: { [key: string]: string | null }):\r\n ActionReturn<{ [key: string]: string | null }>\r\n{\r\n   /** Sets properties on node. */\r\n   function setProperties()\r\n   {\r\n      if (!isObject(properties)) { return; }\r\n\r\n      for (const prop of Object.keys(properties))\r\n      {\r\n         node.style.setProperty(`${prop}`, properties[prop]);\r\n      }\r\n   }\r\n\r\n   setProperties();\r\n\r\n   return {\r\n      /**\r\n       * @param newProperties - Key / value object of properties to set.\r\n       */\r\n      update: (newProperties: { [key: string]: string | null }) =>\r\n      {\r\n         properties = newProperties;\r\n         setProperties();\r\n      }\r\n   };\r\n}\r\n","import { get }                      from 'svelte/store';\r\n\r\nimport { StyleMetric }              from '#runtime/util/dom/style';\r\nimport { ThemeObserver }            from '#runtime/util/dom/theme';\r\nimport { CrossRealm }               from '#runtime/util/realm';\r\nimport { findParentElement }        from '#runtime/util/dom/layout';\r\nimport { isObject }                 from '#runtime/util/object';\r\nimport { isMinimalWritableStore }   from '#runtime/svelte/store/util';\r\n\r\nimport type { ActionReturn }        from 'svelte/action';\r\nimport type { Unsubscriber }        from 'svelte/store';\r\n\r\nimport type { MinimalWritable }     from '#runtime/svelte/store/util';\r\nimport type { FindParentOptions }   from '#runtime/util/dom/layout';\r\n\r\n/**\r\n * Provides a Svelte action that applies inline styles for `padding` to a parent element or `absolute positioning` to\r\n * the action element adjusting for any painted borders defined by CSS `border-image` properties of the target\r\n * node / element of this action.\r\n *\r\n * When enabled, this action computes the effective visual edge insets / painted border using\r\n * {@link #runtime/util/dom/style!StyleMetric.getVisualEdgeInsets} and applies these constraints to either `padding`\r\n * or absolute inline styles so the element aligns correctly within the visible (non-border) content area of its\r\n * container.\r\n *\r\n * Additionally, this action subscribes to {@link #runtime/util/dom/theme!ThemeObserver} and updates constraint\r\n * calculations when any global theme is changed. To force an update of constraint calculations provide and change\r\n * a superfluous / dummy property in the action options.\r\n *\r\n * You may also provide no `action` option, but provide a `store` and the visual edge constraint calculations will\r\n * be updated in the store with no inline styles applied to an element.\r\n *\r\n * @param node - Target element.\r\n *\r\n * @param [options] - Action Options.\r\n *\r\n * @returns Action Lifecycle functions.\r\n */\r\nfunction applyVisualEdgeInsets(node: HTMLElement, options: VisualEdgeInsetsOptions = {}):\r\n ActionReturn<VisualEdgeInsetsOptions>\r\n{\r\n   let state: InternalVisualEdgeState | undefined = new InternalVisualEdgeState(node, options);\r\n\r\n   // This will invoke `state.updateConstraints` immediately.\r\n   let unsubscribe: Unsubscriber | undefined = ThemeObserver.stores.themeName.subscribe(recalculateTrigger);\r\n\r\n   /**\r\n    * Event handler + ThemeObserver subscriber - update constraints.\r\n    *\r\n    * Other instances of `applyVisualEdgeInsets` will trigger an event ('tjs-visual-edge-recalculate') to any action\r\n    * and target node when they are destroyed. This allows recalculation of constraints when other action events\r\n    * targeting the same node occurs.\r\n    */\r\n   function recalculateTrigger()\r\n   {\r\n      state?.updateConstraints();\r\n   }\r\n\r\n   node.addEventListener('tjs-visual-edge-recalculate', recalculateTrigger);\r\n\r\n   return {\r\n      destroy: () =>\r\n      {\r\n         node.removeEventListener('tjs-visual-edge-recalculate', recalculateTrigger);\r\n\r\n         state?.destroy();\r\n         state = void 0;\r\n\r\n         unsubscribe?.();\r\n         unsubscribe = void 0;\r\n      },\r\n\r\n      /**\r\n       * @param newOptions - New options.\r\n       */\r\n      update: (newOptions: VisualEdgeInsetsOptions) => state?.updateOptions(newOptions)\r\n   };\r\n}\r\n\r\n/**\r\n * Extension utility functions for {@link applyVisualEdgeInsets}.\r\n */\r\nnamespace applyVisualEdgeInsets\r\n{\r\n   /**\r\n    * Validates a {@link VisualEdgeSides} value.\r\n    *\r\n    * This utility is attached to {@link applyVisualEdgeInsets} and can be used to perform lightweight runtime checks\r\n    * before passing values to the action. It performs the same structural checks that the action's internal\r\n    * normalization logic uses.\r\n    *\r\n    * @param sides - The value to validate.\r\n    *\r\n    * @returns `true` if the value is a valid `VisualEdgeSides` type otherwise `false`.\r\n    */\r\n   export function validateSides(sides: VisualEdgeSides): sides is VisualEdgeSides\r\n   {\r\n      return typeof sides === 'boolean' || typeof sides === 'string' || isObject(sides);\r\n   }\r\n}\r\n\r\nexport {\r\n   applyVisualEdgeInsets,\r\n   type VisualEdgeInsetsOptions,\r\n   type VisualEdgeSides\r\n};\r\n\r\n/**\r\n * Options for {@link applyVisualEdgeInsets}.\r\n */\r\ninterface VisualEdgeInsetsOptions\r\n{\r\n   /**\r\n    * Specifies which element applies the visual edge constraints inline styles and the type of styles to apply.\r\n    * ```\r\n    * - `absThis`: Applies inline styles to the direct action element for absolute positioning within visual edge\r\n    * constraints of target / parent element.\r\n    *\r\n    * - `padTarget`: Applies inline styles padding the target / parent element with that elements visual edge\r\n    * constraints.\r\n    *\r\n    * - `padThis`: Applies inline styles padding the direct action element with the visual edge constraints of the\r\n    * target / parent element.\r\n    * ```\r\n    *\r\n    * The most common action to use is `padTarget`, but for absolutely positioned overlays use `absThis`.\r\n    */\r\n   action?: 'absThis' | 'padTarget' | 'padThis';\r\n\r\n   /**\r\n    * Which constraint / box sides to apply.\r\n    *\r\n    * Note: The extended `sides` options only apply with `action: 'padTarget'`. For absolute positioning `action: 'absThis'`\r\n    * all four edge constraints are always applied.\r\n    *\r\n    * @defaultValue `true`\r\n    */\r\n   sides?: VisualEdgeSides;\r\n\r\n   /**\r\n    * Enables parent element targeting for visual edge constraint detection.\r\n    *\r\n    * ```\r\n    * - `true`: Direct parent element is the target.\r\n    *\r\n    * - `false`: The action element is the target.\r\n    *\r\n    * - `FindParentOptions` object: This configuration object is passed to `findParentElement`.\r\n    * ```\r\n    *\r\n    * @defaultValue `false`\r\n    *\r\n    * @see {@link #runtime/util/dom/layout!findParentElement}\r\n    */\r\n   parent?: boolean | FindParentOptions;\r\n\r\n   /**\r\n    * A store that is updated with visual edge constraints. Updates to the calculated constraints occur even if `sides`\r\n    * is `false`.\r\n    */\r\n   store?: MinimalWritable<StyleMetric.Data.BoxSides>\r\n\r\n   /**\r\n    * When true, enables console logging of which element is being targeted for visual edge detection, the constraints\r\n    * calculated, along with any element that is has inline styles applied.\r\n    *\r\n    * @defaultValue `false`\r\n    */\r\n   debug?: boolean;\r\n\r\n   /**\r\n    * Allows unknown keys. When an unknown key changes it is ignored, but an update to visual edge constraint\r\n    * calculation occurs. This is useful in the context of local theme changes that may not be picked up by the global\r\n    * {@link ThemeObserver} subscription.\r\n    */\r\n   [key: string]: unknown;\r\n}\r\n\r\n/**\r\n * Defines the application of padding computation for visual edge insets for the {@link applyVisualEdgeInsets} Svelte\r\n * action. For absolute positioning any truthy value enables application of visual edge insets.\r\n *\r\n * ```\r\n * - `false` - Disabled\r\n * - `true` or `'all'` - Enabled / all sides.\r\n * - `'horizontal'` - Left and right sides.\r\n * - `'vertical'` - Top and bottom sides.\r\n * - `object` - Customizable sides with boolean properties for: `top`, `right`, `bottom`, `left`.\r\n * ```\r\n */\r\ntype VisualEdgeSides =\r\n   | false\r\n   | true\r\n   | 'all'\r\n   | 'vertical'\r\n   | 'horizontal'\r\n   | { top?: boolean; right?: boolean; bottom?: boolean; left?: boolean };\r\n\r\n// Internal Implementation -------------------------------------------------------------------------------------------\r\n\r\ninterface NormalizedSides\r\n{\r\n   disabled: boolean;\r\n   all: boolean;\r\n   top: boolean;\r\n   right: boolean;\r\n   bottom: boolean;\r\n   left: boolean;\r\n}\r\n\r\n/**\r\n * Internal state object for the applyVisualEdgeInsets Svelte action. Normalizes all option values and computes the\r\n * effective target node.\r\n */\r\nclass InternalVisualEdgeState\r\n{\r\n   /**\r\n    * The element associated with the action.\r\n    */\r\n   #actionNode: HTMLElement;\r\n\r\n   /**\r\n    * Current target node that is used for visual edge inset calculations.\r\n    */\r\n   #targetNode: Element | null;\r\n\r\n   /**\r\n    * The action to take if applying visual edge constraints.\r\n    */\r\n   #action?: string;\r\n\r\n   /**\r\n    * When true, debug logging is enabled.\r\n    */\r\n   #debug?: boolean;\r\n\r\n   /**\r\n    * Parent element search configuration.\r\n    */\r\n   #parent?: boolean | FindParentOptions;\r\n\r\n   /**\r\n    * Which sides to apply inline styles to for padding.\r\n    */\r\n   #sides: NormalizedSides;\r\n\r\n   /**\r\n    * External store to update with visual edge constraints.\r\n    */\r\n   #store?: MinimalWritable<StyleMetric.Data.BoxSides>;\r\n\r\n   constructor(node: HTMLElement, opts: VisualEdgeInsetsOptions)\r\n   {\r\n      this.#actionNode = node;\r\n\r\n      // Normalize initial options.\r\n      this.#action = typeof opts.action === 'string' ? opts.action : void 0;\r\n      this.#debug = typeof opts.debug === 'boolean' ? opts.debug : false;\r\n      this.#parent = typeof opts.parent === 'boolean' || isObject(opts.parent) ? opts.parent : false;\r\n      this.#sides  = this.#normalizeSides(opts.sides ?? true);\r\n      this.#store = isMinimalWritableStore(opts.store) ? opts.store : void 0;\r\n\r\n      this.#targetNode = this.#resolveParentTarget(this.#parent);\r\n   }\r\n\r\n   /**\r\n    * Destroy all retained references.\r\n    */\r\n   destroy()\r\n   {\r\n      this.#removeStyles();\r\n\r\n      this.#actionNode?.dispatchEvent?.(new CustomEvent('tjs-visual-edge-recalculate'));\r\n      this.#targetNode?.dispatchEvent?.(new CustomEvent('tjs-visual-edge-recalculate'));\r\n\r\n      // @ts-ignore\r\n      this.#actionNode = null;\r\n\r\n      // @ts-ignore\r\n      this.#sides = void 0;\r\n\r\n      this.#targetNode = null;\r\n      this.#parent = void 0;\r\n      this.#store = void 0;\r\n   }\r\n\r\n   /**\r\n    * Update internal options and re-normalize.\r\n    */\r\n   updateOptions(opts: VisualEdgeInsetsOptions)\r\n   {\r\n      if (typeof opts.debug === 'boolean') { this.#debug = opts.debug; }\r\n\r\n      if (opts.action === void 0 || typeof opts.action === 'string')\r\n      {\r\n         let applyAction = true;\r\n\r\n         if (typeof opts.action === 'string' && opts.action !== 'absThis' && opts.action !== 'padTarget' &&\r\n          opts.action !== 'padThis')\r\n         {\r\n            if (this.#debug) { this.#log(`updateOptions - unknown action: ${opts.action}`); }\r\n\r\n            applyAction = false;\r\n         }\r\n\r\n         if (applyAction)\r\n         {\r\n            if (opts.action !== this.#action) { this.#removeStyles(); }\r\n            this.#action = opts.action;\r\n         }\r\n      }\r\n\r\n      if (typeof opts.parent === 'boolean' || isObject(opts.parent)) { this.#parent = opts.parent; }\r\n\r\n      if (opts.sides !== void 0)\r\n      {\r\n         this.#removeStyles();\r\n         this.#sides = this.#normalizeSides(opts.sides);\r\n      }\r\n\r\n      if (opts.store === void 0 || isMinimalWritableStore(opts.store)) { this.#store = opts.store; }\r\n\r\n      // Always recompute the effective target node.\r\n      const newTarget = this.#resolveParentTarget(this.#parent);\r\n\r\n      if (newTarget !== this.#targetNode) { this.#removeStyles(); }\r\n\r\n      this.#targetNode = newTarget;\r\n\r\n      this.updateConstraints();\r\n   }\r\n\r\n   /**\r\n    * Updates visual edge constraint calculation.\r\n    */\r\n   updateConstraints()\r\n   {\r\n      if (this.#targetNode === null) { return; }\r\n\r\n      if (this.#debug) { this.#log(`updateConstraints - target node: `, this.#targetNode); }\r\n\r\n      const constraints: StyleMetric.Data.BoxSides = StyleMetric.getVisualEdgeInsets(this.#targetNode);\r\n\r\n      if (this.#debug) { this.#log(`updateConstraints - new visual edge insets: `, constraints); }\r\n\r\n      if (isMinimalWritableStore(this.#store))\r\n      {\r\n         // Usually avoiding `get` is best practice, but in this case this isn't triggered often, so evaluate existing\r\n         // store value before triggering an update.\r\n\r\n         const current = get(this.#store);\r\n\r\n         if (current?.top !== constraints.top || current?.right !== constraints.right ||\r\n          current?.bottom !== constraints.bottom || current?.left !== constraints.left)\r\n         {\r\n            this.#store.set(constraints);\r\n         }\r\n      }\r\n\r\n      this.#applyStyles(constraints);\r\n   }\r\n\r\n   // Internal implementation ----------------------------------------------------------------------------------------\r\n\r\n   /**\r\n    * Applies styles to target node.\r\n    *\r\n    * @param constraints - Constraints to apply.\r\n    */\r\n   #applyStyles(constraints: StyleMetric.Data.BoxSides)\r\n   {\r\n      if (this.#action === 'padTarget' || this.#action === 'padThis')\r\n      {\r\n         const el = this.#action === 'padTarget' ? this.#targetNode : this.#actionNode;\r\n\r\n         if (!CrossRealm.browser.isHTMLElement(el) || this.#sides.disabled) { return; }\r\n\r\n         if (this.#debug) { this.#log(`#applyStyles (${this.#action}) - element: `, el); }\r\n\r\n         if (this.#sides.all)\r\n         {\r\n            el.style.padding =\r\n             `${constraints.top}px ${constraints.right}px ${constraints.bottom}px ${constraints.left}px`;\r\n         }\r\n         else\r\n         {\r\n            if (this.#sides.top) { el.style.paddingTop = `${constraints.top}px`; }\r\n            if (this.#sides.right) { el.style.paddingRight = `${constraints.right}px`; }\r\n            if (this.#sides.bottom) { el.style.paddingBottom = `${constraints.bottom}px`; }\r\n            if (this.#sides.left) { el.style.paddingLeft = `${constraints.left}px`; }\r\n         }\r\n      }\r\n      else if (this.#action === 'absThis')\r\n      {\r\n         const el = this.#actionNode;\r\n\r\n         if (!this.#sides.disabled)\r\n         {\r\n            if (this.#debug) { this.#log(`#applyStyles (absThis) - element: `, el); }\r\n\r\n            el.style.top = `${constraints.top}px`;\r\n            el.style.left = `${constraints.left}px`;\r\n            el.style.height = `calc(100% - ${constraints.top}px - ${constraints.bottom}px)`;\r\n            el.style.width = `calc(100% - ${constraints.left}px - ${constraints.right}px)`;\r\n            el.style.position = 'absolute';\r\n         }\r\n      }\r\n   }\r\n\r\n   /**\r\n    * @param message - Log message to post.\r\n    *\r\n    * @param [obj] - Object to log.\r\n    */\r\n   #log(message: string, obj: unknown = void 0)\r\n   {\r\n      console.log(`[TRL] applyVisualEdgeInsets - ${message}`, obj);\r\n   }\r\n\r\n   /**\r\n    * Remove styles from target node.\r\n    */\r\n   #removeStyles()\r\n   {\r\n      if (this.#action === 'padTarget' || this.#action === 'padThis')\r\n      {\r\n         const el = this.#action === 'padTarget' ? this.#targetNode : this.#actionNode;\r\n\r\n         if (!CrossRealm.browser.isHTMLElement(el)) { return; }\r\n\r\n         if (this.#debug) { this.#log(`#removeStyles (${this.#action}) - element: `, el); }\r\n\r\n         if (this.#sides.all)\r\n         {\r\n            el.style.padding = '';\r\n         }\r\n         else {\r\n            if (this.#sides.top) el.style.paddingTop = '';\r\n            if (this.#sides.right) el.style.paddingRight = '';\r\n            if (this.#sides.bottom) el.style.paddingBottom = '';\r\n            if (this.#sides.left) el.style.paddingLeft = '';\r\n         }\r\n      }\r\n      else if (this.#action === 'absThis')\r\n      {\r\n         const el = this.#actionNode;\r\n\r\n         if (this.#debug) { this.#log(`#removeStyles (absThis) - element: `, el); }\r\n\r\n         el.style.top = '';\r\n         el.style.left = '';\r\n         el.style.height = '';\r\n         el.style.width = '';\r\n         el.style.position = '';\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Normalize the `parent` option into a meaningful HTMLElement.\r\n    */\r\n   #resolveParentTarget(parent?: boolean | FindParentOptions): Element\r\n   {\r\n      if (parent === void 0 || parent === false) { return this.#actionNode; }\r\n\r\n      if (parent === true) { return this.#actionNode.parentElement ?? this.#actionNode; }\r\n\r\n      // Parent is a `FindParentOptions` object.\r\n      return isObject(parent) ? findParentElement(this.#actionNode, parent) ?? this.#actionNode : this.#actionNode;\r\n   }\r\n\r\n   /**\r\n    * Normalize the `sides` option into a full boolean mask.\r\n    */\r\n   #normalizeSides(sides?: VisualEdgeSides): NormalizedSides\r\n   {\r\n      // Disabled entirely.\r\n      if (sides === false)\r\n      {\r\n         return { disabled: true, all: false, top: false, right: false, bottom: false, left: false };\r\n      }\r\n\r\n      // Default or 'all'.\r\n      if (sides === true || sides === void 0 || sides === 'all')\r\n      {\r\n         return { disabled: false, all: true, top: true, right: true, bottom: true, left: true };\r\n      }\r\n\r\n      if (sides === 'horizontal')\r\n      {\r\n         return { disabled: false, all: false, top: false, right: true, bottom: false, left: true };\r\n      }\r\n\r\n      if (sides === 'vertical')\r\n      {\r\n         return { disabled: false, all: false, top: true, right: false, bottom: true, left: false };\r\n      }\r\n\r\n      // Custom object mask.\r\n      return { disabled: false, all: false, top: !!sides.top, right: !!sides.right, bottom: !!sides.bottom,\r\n       left: !!sides.left };\r\n   }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAIA;;;;;;;;AAQG;AACG,SAAU,WAAW,CAAC,IAAiB,EAAE,UAA4C,EAAA;;AAIxF,IAAA,SAAS,aAAa,GAAA;AAEnB,QAAA,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;YAAE;QAAQ;QAErC,KAAK,MAAM,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,EAC1C;AACG,YAAA,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA,EAAG,IAAI,CAAA,CAAE,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC;QACtD;IACH;AAEA,IAAA,aAAa,EAAE;IAEf,OAAO;AACJ;;AAEG;AACH,QAAA,MAAM,EAAE,CAAC,aAA+C,KAAI;YAEzD,UAAU,GAAG,aAAa;AAC1B,YAAA,aAAa,EAAE;QAClB;KACF;AACJ;;ACxBA;;;;;;;;;;;;;;;;;;;;;;AAsBG;AACH,SAAS,qBAAqB,CAAC,IAAiB,EAAE,UAAmC,EAAE,EAAA;IAGpF,IAAI,KAAK,GAAwC,IAAI,uBAAuB,CAAC,IAAI,EAAE,OAAO,CAAC;;AAG3F,IAAA,IAAI,WAAW,GAA6B,aAAa,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,kBAAkB,CAAC;AAExG;;;;;;AAMG;AACH,IAAA,SAAS,kBAAkB,GAAA;QAExB,KAAK,EAAE,iBAAiB,EAAE;IAC7B;AAEA,IAAA,IAAI,CAAC,gBAAgB,CAAC,6BAA6B,EAAE,kBAAkB,CAAC;IAExE,OAAO;QACJ,OAAO,EAAE,MAAK;AAEX,YAAA,IAAI,CAAC,mBAAmB,CAAC,6BAA6B,EAAE,kBAAkB,CAAC;YAE3E,KAAK,EAAE,OAAO,EAAE;YAChB,KAAK,GAAG,MAAM;YAEd,WAAW,IAAI;YACf,WAAW,GAAG,MAAM;QACvB,CAAC;AAED;;AAEG;QACH,MAAM,EAAE,CAAC,UAAmC,KAAK,KAAK,EAAE,aAAa,CAAC,UAAU;KAClF;AACJ;AAEA;;AAEG;AACH,CAAA,UAAU,qBAAqB,EAAA;AAE5B;;;;;;;;;;AAUG;IACH,SAAgB,aAAa,CAAC,KAAsB,EAAA;AAEjD,QAAA,OAAO,OAAO,KAAK,KAAK,SAAS,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,QAAQ,CAAC,KAAK,CAAC;IACpF;AAHgB,IAAA,qBAAA,CAAA,aAAa,gBAG5B;AACJ,CAAC,EAjBS,qBAAqB,KAArB,qBAAqB,GAAA,EAAA,CAAA,CAAA;AAgI/B;;;AAGG;AACH,MAAM,uBAAuB,CAAA;AAE1B;;AAEG;AACH,IAAA,WAAW;AAEX;;AAEG;AACH,IAAA,WAAW;AAEX;;AAEG;AACH,IAAA,OAAO;AAEP;;AAEG;AACH,IAAA,MAAM;AAEN;;AAEG;AACH,IAAA,OAAO;AAEP;;AAEG;AACH,IAAA,MAAM;AAEN;;AAEG;AACH,IAAA,MAAM;IAEN,WAAA,CAAY,IAAiB,EAAE,IAA6B,EAAA;AAEzD,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI;;QAGvB,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ,GAAG,IAAI,CAAC,MAAM,GAAG,MAAM;AACrE,QAAA,IAAI,CAAC,MAAM,GAAG,OAAO,IAAI,CAAC,KAAK,KAAK,SAAS,GAAG,IAAI,CAAC,KAAK,GAAG,KAAK;QAClE,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,MAAM,KAAK,SAAS,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,KAAK;AAC9F,QAAA,IAAI,CAAC,MAAM,GAAI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC;QACvD,IAAI,CAAC,MAAM,GAAG,sBAAsB,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,GAAG,MAAM;QAEtE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC;IAC7D;AAEA;;AAEG;IACH,OAAO,GAAA;QAEJ,IAAI,CAAC,aAAa,EAAE;AAEpB,QAAA,IAAI,CAAC,WAAW,EAAE,aAAa,GAAG,IAAI,WAAW,CAAC,6BAA6B,CAAC,CAAC;AACjF,QAAA,IAAI,CAAC,WAAW,EAAE,aAAa,GAAG,IAAI,WAAW,CAAC,6BAA6B,CAAC,CAAC;;AAGjF,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI;;AAGvB,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM;AAEpB,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI;AACvB,QAAA,IAAI,CAAC,OAAO,GAAG,MAAM;AACrB,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM;IACvB;AAEA;;AAEG;AACH,IAAA,aAAa,CAAC,IAA6B,EAAA;AAExC,QAAA,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;AAAE,YAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK;QAAE;AAEjE,QAAA,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ,EAC7D;YACG,IAAI,WAAW,GAAG,IAAI;AAEtB,YAAA,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ,IAAI,IAAI,CAAC,MAAM,KAAK,SAAS,IAAI,IAAI,CAAC,MAAM,KAAK,WAAW;AAC9F,gBAAA,IAAI,CAAC,MAAM,KAAK,SAAS,EAC1B;AACG,gBAAA,IAAI,IAAI,CAAC,MAAM,EAAE;oBAAE,IAAI,CAAC,IAAI,CAAC,CAAA,gCAAA,EAAmC,IAAI,CAAC,MAAM,CAAA,CAAE,CAAC;gBAAE;gBAEhF,WAAW,GAAG,KAAK;YACtB;YAEA,IAAI,WAAW,EACf;gBACG,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,OAAO,EAAE;oBAAE,IAAI,CAAC,aAAa,EAAE;gBAAE;AAC1D,gBAAA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM;YAC7B;QACH;AAEA,QAAA,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,SAAS,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;AAAE,YAAA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM;QAAE;AAE7F,QAAA,IAAI,IAAI,CAAC,KAAK,KAAK,MAAM,EACzB;YACG,IAAI,CAAC,aAAa,EAAE;YACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC;QACjD;AAEA,QAAA,IAAI,IAAI,CAAC,KAAK,KAAK,MAAM,IAAI,sBAAsB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;AAAE,YAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK;QAAE;;QAG7F,MAAM,SAAS,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC;AAEzD,QAAA,IAAI,SAAS,KAAK,IAAI,CAAC,WAAW,EAAE;YAAE,IAAI,CAAC,aAAa,EAAE;QAAE;AAE5D,QAAA,IAAI,CAAC,WAAW,GAAG,SAAS;QAE5B,IAAI,CAAC,iBAAiB,EAAE;IAC3B;AAEA;;AAEG;IACH,iBAAiB,GAAA;AAEd,QAAA,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,EAAE;YAAE;QAAQ;AAEzC,QAAA,IAAI,IAAI,CAAC,MAAM,EAAE;YAAE,IAAI,CAAC,IAAI,CAAC,CAAA,iCAAA,CAAmC,EAAE,IAAI,CAAC,WAAW,CAAC;QAAE;QAErF,MAAM,WAAW,GAA8B,WAAW,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC;AAEhG,QAAA,IAAI,IAAI,CAAC,MAAM,EAAE;AAAE,YAAA,IAAI,CAAC,IAAI,CAAC,8CAA8C,EAAE,WAAW,CAAC;QAAE;AAE3F,QAAA,IAAI,sBAAsB,CAAC,IAAI,CAAC,MAAM,CAAC,EACvC;;;YAIG,MAAM,OAAO,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;AAEhC,YAAA,IAAI,OAAO,EAAE,GAAG,KAAK,WAAW,CAAC,GAAG,IAAI,OAAO,EAAE,KAAK,KAAK,WAAW,CAAC,KAAK;AAC3E,gBAAA,OAAO,EAAE,MAAM,KAAK,WAAW,CAAC,MAAM,IAAI,OAAO,EAAE,IAAI,KAAK,WAAW,CAAC,IAAI,EAC7E;AACG,gBAAA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC;YAC/B;QACH;AAEA,QAAA,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;IACjC;;AAIA;;;;AAIG;AACH,IAAA,YAAY,CAAC,WAAsC,EAAA;AAEhD,QAAA,IAAI,IAAI,CAAC,OAAO,KAAK,WAAW,IAAI,IAAI,CAAC,OAAO,KAAK,SAAS,EAC9D;AACG,YAAA,MAAM,EAAE,GAAG,IAAI,CAAC,OAAO,KAAK,WAAW,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW;AAE7E,YAAA,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE;gBAAE;YAAQ;AAE7E,YAAA,IAAI,IAAI,CAAC,MAAM,EAAE;gBAAE,IAAI,CAAC,IAAI,CAAC,CAAA,cAAA,EAAiB,IAAI,CAAC,OAAO,CAAA,aAAA,CAAe,EAAE,EAAE,CAAC;YAAE;AAEhF,YAAA,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,EACnB;gBACG,EAAE,CAAC,KAAK,CAAC,OAAO;AACf,oBAAA,CAAA,EAAG,WAAW,CAAC,GAAG,CAAA,GAAA,EAAM,WAAW,CAAC,KAAK,CAAA,GAAA,EAAM,WAAW,CAAC,MAAM,CAAA,GAAA,EAAM,WAAW,CAAC,IAAI,IAAI;YAC/F;iBAEA;AACG,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE;oBAAE,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,GAAG,WAAW,CAAC,GAAG,CAAA,EAAA,CAAI;gBAAE;AACrE,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;oBAAE,EAAE,CAAC,KAAK,CAAC,YAAY,GAAG,GAAG,WAAW,CAAC,KAAK,CAAA,EAAA,CAAI;gBAAE;AAC3E,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;oBAAE,EAAE,CAAC,KAAK,CAAC,aAAa,GAAG,GAAG,WAAW,CAAC,MAAM,CAAA,EAAA,CAAI;gBAAE;AAC9E,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;oBAAE,EAAE,CAAC,KAAK,CAAC,WAAW,GAAG,GAAG,WAAW,CAAC,IAAI,CAAA,EAAA,CAAI;gBAAE;YAC3E;QACH;AACK,aAAA,IAAI,IAAI,CAAC,OAAO,KAAK,SAAS,EACnC;AACG,YAAA,MAAM,EAAE,GAAG,IAAI,CAAC,WAAW;AAE3B,YAAA,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,EACzB;AACG,gBAAA,IAAI,IAAI,CAAC,MAAM,EAAE;AAAE,oBAAA,IAAI,CAAC,IAAI,CAAC,oCAAoC,EAAE,EAAE,CAAC;gBAAE;gBAExE,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,WAAW,CAAC,GAAG,CAAA,EAAA,CAAI;gBACrC,EAAE,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,WAAW,CAAC,IAAI,CAAA,EAAA,CAAI;AACvC,gBAAA,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,CAAA,YAAA,EAAe,WAAW,CAAC,GAAG,CAAA,KAAA,EAAQ,WAAW,CAAC,MAAM,KAAK;AAC/E,gBAAA,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,CAAA,YAAA,EAAe,WAAW,CAAC,IAAI,CAAA,KAAA,EAAQ,WAAW,CAAC,KAAK,KAAK;AAC9E,gBAAA,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU;YACjC;QACH;IACH;AAEA;;;;AAIG;AACH,IAAA,IAAI,CAAC,OAAe,EAAE,GAAA,GAAe,MAAM,EAAA;QAExC,OAAO,CAAC,GAAG,CAAC,CAAA,8BAAA,EAAiC,OAAO,CAAA,CAAE,EAAE,GAAG,CAAC;IAC/D;AAEA;;AAEG;IACH,aAAa,GAAA;AAEV,QAAA,IAAI,IAAI,CAAC,OAAO,KAAK,WAAW,IAAI,IAAI,CAAC,OAAO,KAAK,SAAS,EAC9D;AACG,YAAA,MAAM,EAAE,GAAG,IAAI,CAAC,OAAO,KAAK,WAAW,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW;YAE7E,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE;gBAAE;YAAQ;AAErD,YAAA,IAAI,IAAI,CAAC,MAAM,EAAE;gBAAE,IAAI,CAAC,IAAI,CAAC,CAAA,eAAA,EAAkB,IAAI,CAAC,OAAO,CAAA,aAAA,CAAe,EAAE,EAAE,CAAC;YAAE;AAEjF,YAAA,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,EACnB;AACG,gBAAA,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE;YACxB;iBACK;AACF,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG;AAAE,oBAAA,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE;AAC7C,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK;AAAE,oBAAA,EAAE,CAAC,KAAK,CAAC,YAAY,GAAG,EAAE;AACjD,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM;AAAE,oBAAA,EAAE,CAAC,KAAK,CAAC,aAAa,GAAG,EAAE;AACnD,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI;AAAE,oBAAA,EAAE,CAAC,KAAK,CAAC,WAAW,GAAG,EAAE;YAClD;QACH;AACK,aAAA,IAAI,IAAI,CAAC,OAAO,KAAK,SAAS,EACnC;AACG,YAAA,MAAM,EAAE,GAAG,IAAI,CAAC,WAAW;AAE3B,YAAA,IAAI,IAAI,CAAC,MAAM,EAAE;AAAE,gBAAA,IAAI,CAAC,IAAI,CAAC,qCAAqC,EAAE,EAAE,CAAC;YAAE;AAEzE,YAAA,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,EAAE;AACjB,YAAA,EAAE,CAAC,KAAK,CAAC,IAAI,GAAG,EAAE;AAClB,YAAA,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE;AACpB,YAAA,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE;AACnB,YAAA,EAAE,CAAC,KAAK,CAAC,QAAQ,GAAG,EAAE;QACzB;IACH;AAEA;;AAEG;AACH,IAAA,oBAAoB,CAAC,MAAoC,EAAA;QAEtD,IAAI,MAAM,KAAK,MAAM,IAAI,MAAM,KAAK,KAAK,EAAE;YAAE,OAAO,IAAI,CAAC,WAAW;QAAE;AAEtE,QAAA,IAAI,MAAM,KAAK,IAAI,EAAE;YAAE,OAAO,IAAI,CAAC,WAAW,CAAC,aAAa,IAAI,IAAI,CAAC,WAAW;QAAE;;QAGlF,OAAO,QAAQ,CAAC,MAAM,CAAC,GAAG,iBAAiB,CAAC,IAAI,CAAC,WAAW,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW;IAC/G;AAEA;;AAEG;AACH,IAAA,eAAe,CAAC,KAAuB,EAAA;;AAGpC,QAAA,IAAI,KAAK,KAAK,KAAK,EACnB;YACG,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE;QAC9F;;AAGA,QAAA,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,MAAM,IAAI,KAAK,KAAK,KAAK,EACzD;YACG,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;QAC1F;AAEA,QAAA,IAAI,KAAK,KAAK,YAAY,EAC1B;YACG,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE;QAC7F;AAEA,QAAA,IAAI,KAAK,KAAK,UAAU,EACxB;YACG,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE;QAC7F;;AAGA,QAAA,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM;AACnG,YAAA,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE;IACxB;AACF;;;;"}